if (process.xbnodeLib) {
	return module.exports = process.xbnodeLib;
}
var fs = require('fs'), path = require('path');
// SAP 2016-05-24: Consider endianness for build target
var os = require('os');

// Look for binary for this platform
var v8 = 'v8-'+ /[0-9]+\.[0-9]+/.exec(process.versions.v8)[0];
// SAP 2016-05-24: Consider endianness for build target location
var modPath = path.join(__dirname, '..', 'bin', process.platform+ '-'+ process.arch+ '-'+ os.endianness()+ '-'+ v8, 'xbnode');
try {
	fs.statSync(modPath+ '.node');
} catch (ex) {
	// No binary!
	throw new Error('`'+ modPath+ '.node` is missing. Try reinstalling `sap-xbnode`?');
}

// Pull in xbnode implementation
process.xbnodeLib = module.exports = require(modPath);
