'use strict';

class PathUtils {
    /**
     * This method checks that the request path matches the 'pathTemplate' path and maps the
     * path parameters to the req.params object.
     *
     * Returns true in case the paths match and false otherwise
     */
    static pathMatcher(req, pathTemplate) {
        const pathPrefix = pathTemplate.split(':')[0];
        //TODO use url.parse
        if (req.url.indexOf(pathPrefix) === 0) {
            var pathParts = pathTemplate.split('/');
            var realPathParts = req.url.split('/');
            if (pathParts.length === realPathParts.length) {
                for (let i in pathParts) {
                    if (pathParts[i][0] === ':') {
                        if (!req.params) {
                            req.params = {};
                        }
                        req.params[pathParts[i].substr(1)] = realPathParts[i];
                    } else if (pathParts[i] !== realPathParts[i]) {
                        //bad path
                        return false;
                    }
                }
                return true;
            }
        }
        return false;
    }
}

module.exports = {
    pathUtils: PathUtils
};